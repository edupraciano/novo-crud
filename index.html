<!DOCTYPE html>
<html>

<head>

  <base target="_top">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/scroller/2.2.0/js/dataTables.scroller.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/scroller/2.1.1/css/scroller.dataTables.min.css" />

</head>

<body>

  <div id="menuDeNavegacao">
    <button onclick="abreCadastroDeFuncionarios()">Formulário de Cadastro</button>
    <button onclick="abreTabelaDeFuncionarios()">Tabela de Funcionário</button>
  </div>

  <div id="formularioDeCadastroDeFuncionario">
    <h2>Cadastro de Funcionário</h2>
    <label for="idDoFuncionario">ID</label>
    <br>
    <input id="idDoFuncionario" type="text" disabled>
    <br><br>
    <label for="nomeDoFuncionario">NOME</label>
    <br>
    <input id="nomeDoFuncionario" type="text">
    <br><br>
    <label for="cargoDoFuncionario">CARGO</label>
    <br>
    <input id="cargoDoFuncionario" type="text">
    <br><br>
    <label for="salarioDoFuncionario">SALÁRIO</label>
    <br>
    <input id="salarioDoFuncionario" type="text">
    <br><br>
    <button onclick="disparaAoClicar()">LANÇAR</button>
  </div>

  <div id="divTabelaDeFuncionarios">
    <h2>Tabela de Funcionários</h2>
    <table id="example" class="display nowrap" style="width:100%">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nome</th>
          <th>Cargo</th>
          <th>Salário</th>
        </tr>
      </thead>
    </table>
  </div>

</body>

<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    margin: 20px;
    padding: 20px;
    background-color: #dffaff;
  }

  #formularioDeCadastroDeFuncionario {
    display: none;
  }

  #divTabelaDeFuncionarios {
    display: none;
  }
</style>

<script>
  var minhaUrl =
    "https://script.google.com/macros/s/AKfycbxTWJu3nx8BV4ddXUReZqAZGTbadLXmkOIZwOrjsXS9Tz09G9UnR-VdWjKQzETn46ER/exec";

  function abreCadastroDeFuncionarios() {
    document.getElementById('formularioDeCadastroDeFuncionario').style.display = 'block';
    document.getElementById('divTabelaDeFuncionarios').style.display = 'none';
  }

  function abreTabelaDeFuncionarios() {
    document.getElementById('formularioDeCadastroDeFuncionario').style.display = 'none';
    document.getElementById('divTabelaDeFuncionarios').style.display = 'block';
    lerDadosDaTabela();
  }

  function disparaAoClicar() {
    var idDoFuncionario = document.getElementById('idDoFuncionario').value;
    var nomeDoFuncionario = document.getElementById('nomeDoFuncionario').value;
    var cargoDoFuncionario = document.getElementById('cargoDoFuncionario').value;
    var salarioDoFuncionario = document.getElementById('salarioDoFuncionario').value;

    $.ajax({
      type: "POST",
      data: {
        qualFuncao: 'entradaDeFuncionario',
        idDoFuncionario: idDoFuncionario,
        nomeDoFuncionario: nomeDoFuncionario,
        cargoDoFuncionario: cargoDoFuncionario,
        salarioDoFuncionario: salarioDoFuncionario,
      },
      url: minhaUrl,
    }).done(function () {
      document.getElementById('idDoFuncionario').value = "";
      document.getElementById('nomeDoFuncionario').value = "";
      document.getElementById('cargoDoFuncionario').value = "";
      document.getElementById('salarioDoFuncionario').value = "";
      alert("Funcionário Cadastrado Com Sucesso!")
      location.reload();
    });
  }

  function lerDadosDaTabela() {

    $.ajax({
      type: "POST",
      data: {
        qualFuncao: 'lerFuncionarios',
      },
      url: minhaUrl,
    }).done(function (data) {

      try {
        $('#example').DataTable().clear();
        $('#example').DataTable().destroy();
      } catch (e) {
        console.log(e);
      }

      var data = JSON.parse(data);
      $('#example').DataTable({
        data: data,
        deferRender: true,
        scrollY: 200,
        scrollCollapse: true,
        scroller: true,
      });

      // ADICIONANDO UM OUVINTE
      let table = new DataTable('#example');

      table.on('click', 'tbody tr', function () {
        abreCadastroDeFuncionarios();
        let data = table.row(this).data();

        document.getElementById('idDoFuncionario').value = data[0];
        document.getElementById('nomeDoFuncionario').value = data[1];
        document.getElementById('cargoDoFuncionario').value = data[2];
        document.getElementById('salarioDoFuncionario').value = data[3];
      });
    });
  }
</script>

</html>